<!DOCTYPE html>
<html>

<head>
  <base target="_top">
  <?!= include("Styles") ?>
  <!-- Calls include function to import CSS from Styles.html -->
</head>

<body>
  <div style="font-size: 0.9em; max-width: 500px; margin: auto;">
    <h2 style="text-align:center; padding-top: 0px; margin-top:4px">New Transaction</h2>

    <label for="symbol">ğŸ’± Symbol</label>
    <input type="text" id="symbol" required>

    <label for="strikePrice">ğŸ¯ Strike Price</label>
    <input type="number" id="strikePrice" step="0.01" min="0" required>

    <label for="putCall">â†•ï¸ Put/Call</label>
    <select id="putCall" required>
    <option value="" disabled selected>Select</option>
    <option value="Put">Put</option>
    <option value="Call">Call</option>
  </select>

    <label for="expiration">â³ Expiration</label>
    <input type="date" id="expiration" required>

    <label for="buyDate">ğŸ—“ï¸ Buy Date</label>
    <input type="date" id="buyDate" required>

    <label for="buyPrice">ğŸ’µ Buy Price</label>
    <input type="number" id="buyPrice" step="0.01" min="0" required>

    <label for="sellDate">ğŸ—“ï¸ Sell Date</label>
    <input type="date" id="sellDate">

    <label for="sellPrice">ğŸ’µ Sell Price</label>
    <input type="number" id="sellPrice" step="0.01" min="0">

    <div style="display: flex; justify-content: center; gap: 10px; margin-top: 4px;">
      <button onclick="cancelTransaction()" style="background-color: #e53935; color: white;">Cancel</button>
      <button onclick="submitTransaction()">Save</button>
    </div>
  </div>

  <script>
    function showMessageAndClose(message) {
      const body = document.body;
      body.innerHTML = `<p style="text-align:center; font-weight:bold; font-size:16px;">${message}</p>`;
      setTimeout(() => google.script.host.close(), 1000);
    }

    function submitTransaction() {
      const symbol = document.getElementById("symbol").value;
      const strikePrice = document.getElementById("strikePrice").value;
      const putCall = document.getElementById("putCall").value;
      const expiration = document.getElementById("expiration").value;
      const buyDate = document.getElementById("buyDate").value;
      const buyPrice = document.getElementById("buyPrice").value;
      const sellDate = document.getElementById("sellDate").value;
      const sellPrice = document.getElementById("sellPrice").value;

      if (!symbol || !strikePrice || !putCall || !expiration || !buyDate || !buyPrice) {
        alert("All required fields must be filled.");
        return;
      }

      google.script.run
        .withSuccessHandler(() => showMessageAndClose("âœ… Transaction Saved"))
        .saveOptionsTransaction(symbol, strikePrice, putCall, expiration, buyDate, buyPrice, sellDate, sellPrice);
    }

    function cancelTransaction() {
      showMessageAndClose("âŒ Transaction Canceled");
    }
  </script>
</body>

</html>